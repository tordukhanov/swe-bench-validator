{
  "repo": "pydata/xarray",
  "instance_id": "pydata__xarray-2922",
  "base_commit": "65a5bff79479c4b56d6f733236fe544b7f4120a8",
  "patch": "diff --git a/xarray/core/common.py b/xarray/core/common.py\n--- a/xarray/core/common.py\n+++ b/xarray/core/common.py\n@@ -745,6 +745,25 @@ def groupby_bins(\n             },\n         )\n \n+    def weighted(self, weights):\n+        \"\"\"\n+        Weighted operations.\n+\n+        Parameters\n+        ----------\n+        weights : DataArray\n+            An array of weights associated with the values in this Dataset.\n+            Each value in the data contributes to the reduction operation\n+            according to its associated weight.\n+\n+        Notes\n+        -----\n+        ``weights`` must be a DataArray and cannot contain missing values.\n+        Missing values can be replaced by ``weights.fillna(0)``.\n+        \"\"\"\n+\n+        return self._weighted_cls(self, weights)\n+\n     def rolling(\n         self,\n         dim: Mapping[Hashable, int] = None,\ndiff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -33,6 +33,7 @@\n     resample,\n     rolling,\n     utils,\n+    weighted,\n )\n from .accessor_dt import CombinedDatetimelikeAccessor\n from .accessor_str import StringAccessor\n@@ -258,6 +259,7 @@ class DataArray(AbstractArray, DataWithCoords):\n     _rolling_cls = rolling.DataArrayRolling\n     _coarsen_cls = rolling.DataArrayCoarsen\n     _resample_cls = resample.DataArrayResample\n+    _weighted_cls = weighted.DataArrayWeighted\n \n     dt = property(CombinedDatetimelikeAccessor)\n \ndiff --git a/xarray/core/dataset.py b/xarray/core/dataset.py\n--- a/xarray/core/dataset.py\n+++ b/xarray/core/dataset.py\n@@ -46,6 +46,7 @@\n     resample,\n     rolling,\n     utils,\n+    weighted,\n )\n from .alignment import _broadcast_helper, _get_broadcast_dims_map_common_coords, align\n from .common import (\n@@ -457,6 +458,7 @@ class Dataset(Mapping, ImplementsDatasetReduce, DataWithCoords):\n     _rolling_cls = rolling.DatasetRolling\n     _coarsen_cls = rolling.DatasetCoarsen\n     _resample_cls = resample.DatasetResample\n+    _weighted_cls = weighted.DatasetWeighted\n \n     def __init__(\n         self,\ndiff --git a/xarray/core/weighted.py b/xarray/core/weighted.py\nnew file mode 100644\n--- /dev/null\n+++ b/xarray/core/weighted.py\n@@ -0,0 +1,255 @@\n+from typing import TYPE_CHECKING, Hashable, Iterable, Optional, Union, overload\n+\n+from .computation import dot\n+from .options import _get_keep_attrs\n+\n+if TYPE_CHECKING:\n+    from .dataarray import DataArray, Dataset\n+\n+_WEIGHTED_REDUCE_DOCSTRING_TEMPLATE = \"\"\"\n+    Reduce this {cls}'s data by a weighted ``{fcn}`` along some dimension(s).\n+\n+    Parameters\n+    ----------\n+    dim : str or sequence of str, optional\n+        Dimension(s) over which to apply the weighted ``{fcn}``.\n+    skipna : bool, optional\n+        If True, skip missing values (as marked by NaN). By default, only\n+        skips missing values for float dtypes; other dtypes either do not\n+        have a sentinel missing value (int) or skipna=True has not been\n+        implemented (object, datetime64 or timedelta64).\n+    keep_attrs : bool, optional\n+        If True, the attributes (``attrs``) will be copied from the original\n+        object to the new one.  If False (default), the new object will be\n+        returned without attributes.\n+\n+    Returns\n+    -------\n+    reduced : {cls}\n+        New {cls} object with weighted ``{fcn}`` applied to its data and\n+        the indicated dimension(s) removed.\n+\n+    Notes\n+    -----\n+        Returns {on_zero} if the ``weights`` sum to 0.0 along the reduced\n+        dimension(s).\n+    \"\"\"\n+\n+_SUM_OF_WEIGHTS_DOCSTRING = \"\"\"\n+    Calculate the sum of weights, accounting for missing values in the data\n+\n+    Parameters\n+    ----------\n+    dim : str or sequence of str, optional\n+        Dimension(s) over which to sum the weights.\n+    keep_attrs : bool, optional\n+        If True, the attributes (``attrs``) will be copied from the original\n+        object to the new one.  If False (default), the new object will be\n+        returned without attributes.\n+\n+    Returns\n+    -------\n+    reduced : {cls}\n+        New {cls} object with the sum of the weights over the given dimension.\n+    \"\"\"\n+\n+\n+class Weighted:\n+    \"\"\"An object that implements weighted operations.\n+\n+    You should create a Weighted object by using the ``DataArray.weighted`` or\n+    ``Dataset.weighted`` methods.\n+\n+    See Also\n+    --------\n+    Dataset.weighted\n+    DataArray.weighted\n+    \"\"\"\n+\n+    __slots__ = (\"obj\", \"weights\")\n+\n+    @overload\n+    def __init__(self, obj: \"DataArray\", weights: \"DataArray\") -> None:\n+        ...\n+\n+    @overload  # noqa: F811\n+    def __init__(self, obj: \"Dataset\", weights: \"DataArray\") -> None:  # noqa: F811\n+        ...\n+\n+    def __init__(self, obj, weights):  # noqa: F811\n+        \"\"\"\n+        Create a Weighted object\n+\n+        Parameters\n+        ----------\n+        obj : DataArray or Dataset\n+            Object over which the weighted reduction operation is applied.\n+        weights : DataArray\n+            An array of weights associated with the values in the obj.\n+            Each value in the obj contributes to the reduction operation\n+            according to its associated weight.\n+\n+        Notes\n+        -----\n+        ``weights`` must be a ``DataArray`` and cannot contain missing values.\n+        Missing values can be replaced by ``weights.fillna(0)``.\n+        \"\"\"\n+\n+        from .dataarray import DataArray\n+\n+        if not isinstance(weights, DataArray):\n+            raise ValueError(\"`weights` must be a DataArray\")\n+\n+        if weights.isnull().any():\n+            raise ValueError(\n+                \"`weights` cannot contain missing values. \"\n+                \"Missing values can be replaced by `weights.fillna(0)`.\"\n+            )\n+\n+        self.obj = obj\n+        self.weights = weights\n+\n+    @staticmethod\n+    def _reduce(\n+        da: \"DataArray\",\n+        weights: \"DataArray\",\n+        dim: Optional[Union[Hashable, Iterable[Hashable]]] = None,\n+        skipna: Optional[bool] = None,\n+    ) -> \"DataArray\":\n+        \"\"\"reduce using dot; equivalent to (da * weights).sum(dim, skipna)\n+\n+            for internal use only\n+        \"\"\"\n+\n+        # need to infer dims as we use `dot`\n+        if dim is None:\n+            dim = ...\n+\n+        # need to mask invalid values in da, as `dot` does not implement skipna\n+        if skipna or (skipna is None and da.dtype.kind in \"cfO\"):\n+            da = da.fillna(0.0)\n+\n+        # `dot` does not broadcast arrays, so this avoids creating a large\n+        # DataArray (if `weights` has additional dimensions)\n+        # maybe add fasttrack (`(da * weights).sum(dims=dim, skipna=skipna)`)\n+        return dot(da, weights, dims=dim)\n+\n+    def _sum_of_weights(\n+        self, da: \"DataArray\", dim: Optional[Union[Hashable, Iterable[Hashable]]] = None\n+    ) -> \"DataArray\":\n+        \"\"\" Calculate the sum of weights, accounting for missing values \"\"\"\n+\n+        # we need to mask data values that are nan; else the weights are wrong\n+        mask = da.notnull()\n+\n+        sum_of_weights = self._reduce(mask, self.weights, dim=dim, skipna=False)\n+\n+        # 0-weights are not valid\n+        valid_weights = sum_of_weights != 0.0\n+\n+        return sum_of_weights.where(valid_weights)\n+\n+    def _weighted_sum(\n+        self,\n+        da: \"DataArray\",\n+        dim: Optional[Union[Hashable, Iterable[Hashable]]] = None,\n+        skipna: Optional[bool] = None,\n+    ) -> \"DataArray\":\n+        \"\"\"Reduce a DataArray by a by a weighted ``sum`` along some dimension(s).\"\"\"\n+\n+        return self._reduce(da, self.weights, dim=dim, skipna=skipna)\n+\n+    def _weighted_mean(\n+        self,\n+        da: \"DataArray\",\n+        dim: Optional[Union[Hashable, Iterable[Hashable]]] = None,\n+        skipna: Optional[bool] = None,\n+    ) -> \"DataArray\":\n+        \"\"\"Reduce a DataArray by a weighted ``mean`` along some dimension(s).\"\"\"\n+\n+        weighted_sum = self._weighted_sum(da, dim=dim, skipna=skipna)\n+\n+        sum_of_weights = self._sum_of_weights(da, dim=dim)\n+\n+        return weighted_sum / sum_of_weights\n+\n+    def _implementation(self, func, dim, **kwargs):\n+\n+        raise NotImplementedError(\"Use `Dataset.weighted` or `DataArray.weighted`\")\n+\n+    def sum_of_weights(\n+        self,\n+        dim: Optional[Union[Hashable, Iterable[Hashable]]] = None,\n+        keep_attrs: Optional[bool] = None,\n+    ) -> Union[\"DataArray\", \"Dataset\"]:\n+\n+        return self._implementation(\n+            self._sum_of_weights, dim=dim, keep_attrs=keep_attrs\n+        )\n+\n+    def sum(\n+        self,\n+        dim: Optional[Union[Hashable, Iterable[Hashable]]] = None,\n+        skipna: Optional[bool] = None,\n+        keep_attrs: Optional[bool] = None,\n+    ) -> Union[\"DataArray\", \"Dataset\"]:\n+\n+        return self._implementation(\n+            self._weighted_sum, dim=dim, skipna=skipna, keep_attrs=keep_attrs\n+        )\n+\n+    def mean(\n+        self,\n+        dim: Optional[Union[Hashable, Iterable[Hashable]]] = None,\n+        skipna: Optional[bool] = None,\n+        keep_attrs: Optional[bool] = None,\n+    ) -> Union[\"DataArray\", \"Dataset\"]:\n+\n+        return self._implementation(\n+            self._weighted_mean, dim=dim, skipna=skipna, keep_attrs=keep_attrs\n+        )\n+\n+    def __repr__(self):\n+        \"\"\"provide a nice str repr of our Weighted object\"\"\"\n+\n+        klass = self.__class__.__name__\n+        weight_dims = \", \".join(self.weights.dims)\n+        return f\"{klass} with weights along dimensions: {weight_dims}\"\n+\n+\n+class DataArrayWeighted(Weighted):\n+    def _implementation(self, func, dim, **kwargs):\n+\n+        keep_attrs = kwargs.pop(\"keep_attrs\")\n+        if keep_attrs is None:\n+            keep_attrs = _get_keep_attrs(default=False)\n+\n+        weighted = func(self.obj, dim=dim, **kwargs)\n+\n+        if keep_attrs:\n+            weighted.attrs = self.obj.attrs\n+\n+        return weighted\n+\n+\n+class DatasetWeighted(Weighted):\n+    def _implementation(self, func, dim, **kwargs) -> \"Dataset\":\n+\n+        return self.obj.map(func, dim=dim, **kwargs)\n+\n+\n+def _inject_docstring(cls, cls_name):\n+\n+    cls.sum_of_weights.__doc__ = _SUM_OF_WEIGHTS_DOCSTRING.format(cls=cls_name)\n+\n+    cls.sum.__doc__ = _WEIGHTED_REDUCE_DOCSTRING_TEMPLATE.format(\n+        cls=cls_name, fcn=\"sum\", on_zero=\"0\"\n+    )\n+\n+    cls.mean.__doc__ = _WEIGHTED_REDUCE_DOCSTRING_TEMPLATE.format(\n+        cls=cls_name, fcn=\"mean\", on_zero=\"NaN\"\n+    )\n+\n+\n+_inject_docstring(DataArrayWeighted, \"DataArray\")\n+_inject_docstring(DatasetWeighted, \"Dataset\")\n",
  "test_patch": "diff --git a/xarray/tests/test_weighted.py b/xarray/tests/test_weighted.py\nnew file mode 100644\n--- /dev/null\n+++ b/xarray/tests/test_weighted.py\n@@ -0,0 +1,311 @@\n+import numpy as np\n+import pytest\n+\n+import xarray as xr\n+from xarray import DataArray\n+from xarray.tests import assert_allclose, assert_equal, raises_regex\n+\n+\n+@pytest.mark.parametrize(\"as_dataset\", (True, False))\n+def test_weighted_non_DataArray_weights(as_dataset):\n+\n+    data = DataArray([1, 2])\n+    if as_dataset:\n+        data = data.to_dataset(name=\"data\")\n+\n+    with raises_regex(ValueError, \"`weights` must be a DataArray\"):\n+        data.weighted([1, 2])\n+\n+\n+@pytest.mark.parametrize(\"as_dataset\", (True, False))\n+@pytest.mark.parametrize(\"weights\", ([np.nan, 2], [np.nan, np.nan]))\n+def test_weighted_weights_nan_raises(as_dataset, weights):\n+\n+    data = DataArray([1, 2])\n+    if as_dataset:\n+        data = data.to_dataset(name=\"data\")\n+\n+    with pytest.raises(ValueError, match=\"`weights` cannot contain missing values.\"):\n+        data.weighted(DataArray(weights))\n+\n+\n+@pytest.mark.parametrize(\n+    (\"weights\", \"expected\"),\n+    (([1, 2], 3), ([2, 0], 2), ([0, 0], np.nan), ([-1, 1], np.nan)),\n+)\n+def test_weighted_sum_of_weights_no_nan(weights, expected):\n+\n+    da = DataArray([1, 2])\n+    weights = DataArray(weights)\n+    result = da.weighted(weights).sum_of_weights()\n+\n+    expected = DataArray(expected)\n+\n+    assert_equal(expected, result)\n+\n+\n+@pytest.mark.parametrize(\n+    (\"weights\", \"expected\"),\n+    (([1, 2], 2), ([2, 0], np.nan), ([0, 0], np.nan), ([-1, 1], 1)),\n+)\n+def test_weighted_sum_of_weights_nan(weights, expected):\n+\n+    da = DataArray([np.nan, 2])\n+    weights = DataArray(weights)\n+    result = da.weighted(weights).sum_of_weights()\n+\n+    expected = DataArray(expected)\n+\n+    assert_equal(expected, result)\n+\n+\n+@pytest.mark.parametrize(\"da\", ([1.0, 2], [1, np.nan], [np.nan, np.nan]))\n+@pytest.mark.parametrize(\"factor\", [0, 1, 3.14])\n+@pytest.mark.parametrize(\"skipna\", (True, False))\n+def test_weighted_sum_equal_weights(da, factor, skipna):\n+    # if all weights are 'f'; weighted sum is f times the ordinary sum\n+\n+    da = DataArray(da)\n+    weights = xr.full_like(da, factor)\n+\n+    expected = da.sum(skipna=skipna) * factor\n+    result = da.weighted(weights).sum(skipna=skipna)\n+\n+    assert_equal(expected, result)\n+\n+\n+@pytest.mark.parametrize(\n+    (\"weights\", \"expected\"), (([1, 2], 5), ([0, 2], 4), ([0, 0], 0))\n+)\n+def test_weighted_sum_no_nan(weights, expected):\n+\n+    da = DataArray([1, 2])\n+\n+    weights = DataArray(weights)\n+    result = da.weighted(weights).sum()\n+    expected = DataArray(expected)\n+\n+    assert_equal(expected, result)\n+\n+\n+@pytest.mark.parametrize(\n+    (\"weights\", \"expected\"), (([1, 2], 4), ([0, 2], 4), ([1, 0], 0), ([0, 0], 0))\n+)\n+@pytest.mark.parametrize(\"skipna\", (True, False))\n+def test_weighted_sum_nan(weights, expected, skipna):\n+\n+    da = DataArray([np.nan, 2])\n+\n+    weights = DataArray(weights)\n+    result = da.weighted(weights).sum(skipna=skipna)\n+\n+    if skipna:\n+        expected = DataArray(expected)\n+    else:\n+        expected = DataArray(np.nan)\n+\n+    assert_equal(expected, result)\n+\n+\n+@pytest.mark.filterwarnings(\"ignore:Mean of empty slice\")\n+@pytest.mark.parametrize(\"da\", ([1.0, 2], [1, np.nan], [np.nan, np.nan]))\n+@pytest.mark.parametrize(\"skipna\", (True, False))\n+@pytest.mark.parametrize(\"factor\", [1, 2, 3.14])\n+def test_weighted_mean_equal_weights(da, skipna, factor):\n+    # if all weights are equal (!= 0), should yield the same result as mean\n+\n+    da = DataArray(da)\n+\n+    # all weights as 1.\n+    weights = xr.full_like(da, factor)\n+\n+    expected = da.mean(skipna=skipna)\n+    result = da.weighted(weights).mean(skipna=skipna)\n+\n+    assert_equal(expected, result)\n+\n+\n+@pytest.mark.parametrize(\n+    (\"weights\", \"expected\"), (([4, 6], 1.6), ([1, 0], 1.0), ([0, 0], np.nan))\n+)\n+def test_weighted_mean_no_nan(weights, expected):\n+\n+    da = DataArray([1, 2])\n+    weights = DataArray(weights)\n+    expected = DataArray(expected)\n+\n+    result = da.weighted(weights).mean()\n+\n+    assert_equal(expected, result)\n+\n+\n+@pytest.mark.parametrize(\n+    (\"weights\", \"expected\"), (([4, 6], 2.0), ([1, 0], np.nan), ([0, 0], np.nan))\n+)\n+@pytest.mark.parametrize(\"skipna\", (True, False))\n+def test_weighted_mean_nan(weights, expected, skipna):\n+\n+    da = DataArray([np.nan, 2])\n+    weights = DataArray(weights)\n+\n+    if skipna:\n+        expected = DataArray(expected)\n+    else:\n+        expected = DataArray(np.nan)\n+\n+    result = da.weighted(weights).mean(skipna=skipna)\n+\n+    assert_equal(expected, result)\n+\n+\n+def expected_weighted(da, weights, dim, skipna, operation):\n+    \"\"\"\n+    Generate expected result using ``*`` and ``sum``. This is checked against\n+    the result of da.weighted which uses ``dot``\n+    \"\"\"\n+\n+    weighted_sum = (da * weights).sum(dim=dim, skipna=skipna)\n+\n+    if operation == \"sum\":\n+        return weighted_sum\n+\n+    masked_weights = weights.where(da.notnull())\n+    sum_of_weights = masked_weights.sum(dim=dim, skipna=True)\n+    valid_weights = sum_of_weights != 0\n+    sum_of_weights = sum_of_weights.where(valid_weights)\n+\n+    if operation == \"sum_of_weights\":\n+        return sum_of_weights\n+\n+    weighted_mean = weighted_sum / sum_of_weights\n+\n+    if operation == \"mean\":\n+        return weighted_mean\n+\n+\n+@pytest.mark.parametrize(\"dim\", (\"a\", \"b\", \"c\", (\"a\", \"b\"), (\"a\", \"b\", \"c\"), None))\n+@pytest.mark.parametrize(\"operation\", (\"sum_of_weights\", \"sum\", \"mean\"))\n+@pytest.mark.parametrize(\"add_nans\", (True, False))\n+@pytest.mark.parametrize(\"skipna\", (None, True, False))\n+@pytest.mark.parametrize(\"as_dataset\", (True, False))\n+def test_weighted_operations_3D(dim, operation, add_nans, skipna, as_dataset):\n+\n+    dims = (\"a\", \"b\", \"c\")\n+    coords = dict(a=[0, 1, 2, 3], b=[0, 1, 2, 3], c=[0, 1, 2, 3])\n+\n+    weights = DataArray(np.random.randn(4, 4, 4), dims=dims, coords=coords)\n+\n+    data = np.random.randn(4, 4, 4)\n+\n+    # add approximately 25 % NaNs (https://stackoverflow.com/a/32182680/3010700)\n+    if add_nans:\n+        c = int(data.size * 0.25)\n+        data.ravel()[np.random.choice(data.size, c, replace=False)] = np.NaN\n+\n+    data = DataArray(data, dims=dims, coords=coords)\n+\n+    if as_dataset:\n+        data = data.to_dataset(name=\"data\")\n+\n+    if operation == \"sum_of_weights\":\n+        result = data.weighted(weights).sum_of_weights(dim)\n+    else:\n+        result = getattr(data.weighted(weights), operation)(dim, skipna=skipna)\n+\n+    expected = expected_weighted(data, weights, dim, skipna, operation)\n+\n+    assert_allclose(expected, result)\n+\n+\n+@pytest.mark.parametrize(\"operation\", (\"sum_of_weights\", \"sum\", \"mean\"))\n+@pytest.mark.parametrize(\"as_dataset\", (True, False))\n+def test_weighted_operations_nonequal_coords(operation, as_dataset):\n+\n+    weights = DataArray(np.random.randn(4), dims=(\"a\",), coords=dict(a=[0, 1, 2, 3]))\n+    data = DataArray(np.random.randn(4), dims=(\"a\",), coords=dict(a=[1, 2, 3, 4]))\n+\n+    if as_dataset:\n+        data = data.to_dataset(name=\"data\")\n+\n+    expected = expected_weighted(\n+        data, weights, dim=\"a\", skipna=None, operation=operation\n+    )\n+    result = getattr(data.weighted(weights), operation)(dim=\"a\")\n+\n+    assert_allclose(expected, result)\n+\n+\n+@pytest.mark.parametrize(\"dim\", (\"dim_0\", None))\n+@pytest.mark.parametrize(\"shape_data\", ((4,), (4, 4), (4, 4, 4)))\n+@pytest.mark.parametrize(\"shape_weights\", ((4,), (4, 4), (4, 4, 4)))\n+@pytest.mark.parametrize(\"operation\", (\"sum_of_weights\", \"sum\", \"mean\"))\n+@pytest.mark.parametrize(\"add_nans\", (True, False))\n+@pytest.mark.parametrize(\"skipna\", (None, True, False))\n+@pytest.mark.parametrize(\"as_dataset\", (True, False))\n+def test_weighted_operations_different_shapes(\n+    dim, shape_data, shape_weights, operation, add_nans, skipna, as_dataset\n+):\n+\n+    weights = DataArray(np.random.randn(*shape_weights))\n+\n+    data = np.random.randn(*shape_data)\n+\n+    # add approximately 25 % NaNs\n+    if add_nans:\n+        c = int(data.size * 0.25)\n+        data.ravel()[np.random.choice(data.size, c, replace=False)] = np.NaN\n+\n+    data = DataArray(data)\n+\n+    if as_dataset:\n+        data = data.to_dataset(name=\"data\")\n+\n+    if operation == \"sum_of_weights\":\n+        result = getattr(data.weighted(weights), operation)(dim)\n+    else:\n+        result = getattr(data.weighted(weights), operation)(dim, skipna=skipna)\n+\n+    expected = expected_weighted(data, weights, dim, skipna, operation)\n+\n+    assert_allclose(expected, result)\n+\n+\n+@pytest.mark.parametrize(\"operation\", (\"sum_of_weights\", \"sum\", \"mean\"))\n+@pytest.mark.parametrize(\"as_dataset\", (True, False))\n+@pytest.mark.parametrize(\"keep_attrs\", (True, False, None))\n+def test_weighted_operations_keep_attr(operation, as_dataset, keep_attrs):\n+\n+    weights = DataArray(np.random.randn(2, 2), attrs=dict(attr=\"weights\"))\n+    data = DataArray(np.random.randn(2, 2))\n+\n+    if as_dataset:\n+        data = data.to_dataset(name=\"data\")\n+\n+    data.attrs = dict(attr=\"weights\")\n+\n+    result = getattr(data.weighted(weights), operation)(keep_attrs=True)\n+\n+    if operation == \"sum_of_weights\":\n+        assert weights.attrs == result.attrs\n+    else:\n+        assert data.attrs == result.attrs\n+\n+    result = getattr(data.weighted(weights), operation)(keep_attrs=None)\n+    assert not result.attrs\n+\n+    result = getattr(data.weighted(weights), operation)(keep_attrs=False)\n+    assert not result.attrs\n+\n+\n+@pytest.mark.xfail(reason=\"xr.Dataset.map does not copy attrs of DataArrays GH: 3595\")\n+@pytest.mark.parametrize(\"operation\", (\"sum\", \"mean\"))\n+def test_weighted_operations_keep_attr_da_in_ds(operation):\n+    # GH #3595\n+\n+    weights = DataArray(np.random.randn(2, 2))\n+    data = DataArray(np.random.randn(2, 2), attrs=dict(attr=\"data\"))\n+    data = data.to_dataset(name=\"a\")\n+\n+    result = getattr(data.weighted(weights), operation)(keep_attrs=True)\n+\n+    assert data.a.attrs == result.a.attrs\n",
  "problem_statement": "add average function\nIt would be nice to be able to do `ds.average()` to compute weighted averages (e.g. for geo data). Of course this would require the axes to be in a predictable order. Or to give a weight per dimension...\n\n",
  "hints_text": "Module error checking, etc., this would look something like:\n\n``` python\ndef average(self, dim=None, weights=None):\n    if weights is None:\n        return self.mean(dim)\n    else:\n        return (self * weights).sum(dim) / weights.sum(dim)\n```\n\nThis is pretty easy to do manually, but I can see the value in having the standard method around, so I'm definitely open to PRs to add this functionality.\n\nThis is has to be adjusted if there are `NaN` in the array. `weights.sum(dim)` needs to be corrected not to count weights on indices where there is a `NaN` in `self`. \n\nIs there a better way to get the correct weights than:\n\n```\ntotal_weights = weights.sum(dim) * self / self\n```\n\nIt should probably not be used on a Dataset as every DataArray may have its own `NaN` structure. Or the equivalent Dataset method should loop through the DataArrays.\n\nPossibly using where, e.g., `weights.where(self.notnull()).sum(dim)`.\n\nThanks - that seems to be the fastest possibility. I wrote the functions for Dataset and DataArray\n\n``` python\ndef average_da(self, dim=None, weights=None):\n    \"\"\"\n    weighted average for DataArrays\n\n    Parameters\n    ----------\n    dim : str or sequence of str, optional\n        Dimension(s) over which to apply average.\n    weights : DataArray\n        weights to apply. Shape must be broadcastable to shape of self.\n\n    Returns\n    -------\n    reduced : DataArray\n        New DataArray with average applied to its data and the indicated\n        dimension(s) removed.\n\n    \"\"\"\n\n    if weights is None:\n        return self.mean(dim)\n    else:\n        if not isinstance(weights, xray.DataArray):\n            raise ValueError(\"weights must be a DataArray\")\n\n        # if NaNs are present, we need individual weights\n        if self.notnull().any():\n            total_weights = weights.where(self.notnull()).sum(dim=dim)\n        else:\n            total_weights = weights.sum(dim)\n\n        return (self * weights).sum(dim) / total_weights\n\n# -----------------------------------------------------------------------------\n\ndef average_ds(self, dim=None, weights=None):\n    \"\"\"\n    weighted average for Datasets\n\n    Parameters\n    ----------\n    dim : str or sequence of str, optional\n        Dimension(s) over which to apply average.\n    weights : DataArray\n        weights to apply. Shape must be broadcastable to shape of data.\n\n    Returns\n    -------\n    reduced : Dataset\n        New Dataset with average applied to its data and the indicated\n        dimension(s) removed.\n\n    \"\"\"\n\n    if weights is None:\n        return self.mean(dim)\n    else:\n        return self.apply(average_da, dim=dim, weights=weights)\n```\n\nThey can be combined to one function:\n\n``` python\ndef average(data, dim=None, weights=None):\n    \"\"\"\n    weighted average for xray objects\n\n    Parameters\n    ----------\n    data : Dataset or DataArray\n        the xray object to average over\n    dim : str or sequence of str, optional\n        Dimension(s) over which to apply average.\n    weights : DataArray\n        weights to apply. Shape must be broadcastable to shape of data.\n\n    Returns\n    -------\n    reduced : Dataset or DataArray\n        New xray object with average applied to its data and the indicated\n        dimension(s) removed.\n\n    \"\"\"\n\n    if isinstance(data, xray.Dataset):\n        return average_ds(data, dim, weights)\n    elif isinstance(data, xray.DataArray):\n        return average_da(data, dim, weights)\n    else:\n        raise ValueError(\"date must be an xray Dataset or DataArray\")\n```\n\nOr a monkey patch:\n\n``` python\nxray.DataArray.average = average_da\nxray.Dataset.average = average_ds\n```\n\n@MaximilianR has suggested a `groupby`/`rolling`-like interface to weighted reductions. \n\n``` Python\nda.weighted(weights=ds.dim).mean()\n# or maybe\nda.weighted(time=days_per_month(da.time)).mean()\n```\n\nI really like this idea, as does @shoyer.  I'm going to close my PR in hopes of this becoming reality.\n\nI would suggest not using keyword arguments for `weighted`. Instead, just align based on the labels of the argument like regular xarray operations. So we'd write `da.weighted(days_per_month(da.time)).mean()`\n\nSounds like a clean solution. Then we can defer handling of NaN in the weights to `weighted` (e.g. by a `skipna_weights` argument in `weighted`). Also returning `sum_of_weights` can be a method of the class.\n\nWe may still end up implementing all required methods separately in `weighted`. For mean we do:\n\n```\n(data * weights / sum_of_weights).sum(dim=dim)\n```\n\ni.e. we use `sum` and not `mean`. We could rewrite this to:\n\n```\n(data * weights / sum_of_weights).mean(dim=dim) * weights.count(dim=dim)\n```\n\nHowever, I think this can not be generalized to a `reduce` function. See e.g. for `std` http://stackoverflow.com/questions/30383270/how-do-i-calculate-the-standard-deviation-between-weighted-measurements\n\nAdditionally, `weighted` does not make sense for many operations (I would say) e.g.: `min`, `max`, `count`, ...\n\nDo we want\n\n```\nda.weighted(weight, dim='time').mean()\n```\n\nor\n\n```\nda.weighted(weight).mean(dim='time')\n```\n\n@mathause -\n\nI would think you want the latter (`da.weighted(weight).mean(dim='time')`). `weighted` should handle the brodcasting of `weight` such that you could do this:\n\n``` Python\n>>> da.shape\n(72, 10, 15)\n>>> da.dims\n('time', 'x', 'y')\n>>> weights = some_func_of_time(time)\n>>> da.weighted(weights).mean(dim=('time', 'x'))\n...\n```\n\nYes, +1 for `da.weighted(weight).mean(dim='time')`. The `mean` method on `weighted` should have the same arguments as the `mean` method on `DataArray` -- it's just changed due to the context.\n\n> We may still end up implementing all required methods separately in weighted.\n\nThis is a fair point, I haven't looked in to the details of these implementations yet. But I expect there are still at least a few picks of logic that we will be able to share.\n\n@mathause can you please comment on the status of this issue?  Is there an associated PR somewhere?  Thanks!\nHi,\r\n\r\nmy research group recently discussed weighted averaging with x-array, and I was wondering if there had been any progress with implementing this? I'd be happy to get involved if help is needed.\r\n\r\nThanks!\nHi,\r\n\r\nThis would be a really nice feature to have. I'd be happy to help too.\r\n\r\nThank you\nFound this issue due to @rabernats [blogpost](https://medium.com/pangeo/supporting-new-xarray-contributors-6c42b12b0811). This is a much requested feature in our working group, and it would be great to build onto it in xgcm aswell.\r\nI would be very keen to help this advance. \nIt would be great to have some progress on this issue!  @mathause, @pgierz, @markelg, or @jbusecke if there is anything we can do to help you get started let us know.\nI have to say that I am still pretty bad at thinking fully object orientented, but is this what we want in general?\r\nA subclass `of xr.DataArray` which gets initialized with a weight array and with some logic for nans then 'knows' about the weight count? Where would I find a good analogue for this sort of organization? In the `rolling` class?\r\n\r\nI like the syntax proposed by @jhamman above, but I am wondering what happens in a slightly modified example:\r\n```\r\n>>> da.shape\r\n(72, 10, 15)\r\n>>> da.dims\r\n('time', 'x', 'y')\r\n>>> weights = some_func_of_x(x)\r\n>>> da.weighted(weights).mean(dim=('x', 'y'))\r\n```\r\nI think we should maybe build in a warning that when the `weights` array does not contain both of the average dimensions? \r\n\r\nIt was mentioned that the functions on `...weighted()`, would have to be mostly rewritten since the logic for a weigthed average and std differs. What other functions should be included (if any)?\n> I think we should maybe build in a warning that when the weights array does not contain both of the average dimensions?\r\n\r\nhmm.. the intent here would be that the weights are broadcasted against the input array no? Not sure that a warning is required. e.g. @shoyer's comment above:\r\n\r\n> I would suggest not using keyword arguments for `weighted`. Instead, just align based on the labels of the argument like regular xarray operations. So we'd write `da.weighted(days_per_month(da.time)).mean()`\r\n\r\nAre we going to require that the argument to `weighted` is a `DataArray` that shares at least one dimension with `da`?\nPoint taken. I am still not thinking general enough :-)\r\n\r\n> Are we going to require that the argument to weighted is a DataArray that shares at least one dimension with da?\r\n\r\nThis sounds good to me. \r\n\r\nWith regard to the implementation, I thought of orienting myself along the lines of `groupby`, `rolling` or `resample`. Or are there any concerns for this specific method?\nMaybe a bad question, but is there a good jumping off point to gain some familiarity with the code base? It’s admittedly my first time looking at xarray from the inside...\n@pgierz take a look at the \"good first issue\" label: https://github.com/pydata/xarray/issues?q=is%3Aopen+is%3Aissue+label%3A%22good+first+issue%22\n@pgierz  - Our documentation has a page on [contributing](http://xarray.pydata.org/en/stable/contributing.html) which I encourage you to read through. ~Unfortunately, we don't have any \"developer documentation\" to explain the actual code base itself. That would be good to add at some point.~\r\n**Edit**: that was wrong. We have a page on [xarray internals](http://xarray.pydata.org/en/stable/internals.html).\r\n \r\nOnce you have your local development environment set up and your fork cloned, the next step is to start exploring the source code and figuring out where changes need to be made. At that point, you can post any questions you have here and we will be happy to give you some guidance.\nCan the stats functions from https://esmlab.readthedocs.io/en/latest/api.html#statistics-functions be used?\n> With regard to the implementation, I thought of orienting myself along the lines of groupby, rolling or resample. Or are there any concerns for this specific method?\r\n\r\nI would do the same i.e. take inspiration from the groupby / rolling / resample modules. ",
  "created_at": "2019-04-26T17:09:02Z",
  "version": "0.12",
  "FAIL_TO_PASS": "[\"xarray/tests/test_weighted.py::test_weighted_non_DataArray_weights[True]\", \"xarray/tests/test_weighted.py::test_weighted_non_DataArray_weights[False]\", \"xarray/tests/test_weighted.py::test_weighted_weights_nan_raises[weights0-True]\", \"xarray/tests/test_weighted.py::test_weighted_weights_nan_raises[weights0-False]\", \"xarray/tests/test_weighted.py::test_weighted_weights_nan_raises[weights1-True]\", \"xarray/tests/test_weighted.py::test_weighted_weights_nan_raises[weights1-False]\", \"xarray/tests/test_weighted.py::test_weighted_sum_of_weights_no_nan[weights0-3]\", \"xarray/tests/test_weighted.py::test_weighted_sum_of_weights_no_nan[weights1-2]\", \"xarray/tests/test_weighted.py::test_weighted_sum_of_weights_no_nan[weights2-nan]\", \"xarray/tests/test_weighted.py::test_weighted_sum_of_weights_no_nan[weights3-nan]\", \"xarray/tests/test_weighted.py::test_weighted_sum_of_weights_nan[weights0-2]\", \"xarray/tests/test_weighted.py::test_weighted_sum_of_weights_nan[weights1-nan]\", \"xarray/tests/test_weighted.py::test_weighted_sum_of_weights_nan[weights2-nan]\", \"xarray/tests/test_weighted.py::test_weighted_sum_of_weights_nan[weights3-1]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-0-da0]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-0-da1]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-0-da2]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-1-da0]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-1-da1]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-1-da2]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-3.14-da0]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-3.14-da1]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[True-3.14-da2]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-0-da0]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-0-da1]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-0-da2]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-1-da0]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-1-da1]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-1-da2]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-3.14-da0]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-3.14-da1]\", \"xarray/tests/test_weighted.py::test_weighted_sum_equal_weights[False-3.14-da2]\", \"xarray/tests/test_weighted.py::test_weighted_sum_no_nan[weights0-5]\", \"xarray/tests/test_weighted.py::test_weighted_sum_no_nan[weights1-4]\", \"xarray/tests/test_weighted.py::test_weighted_sum_no_nan[weights2-0]\", \"xarray/tests/test_weighted.py::test_weighted_sum_nan[True-weights0-4]\", \"xarray/tests/test_weighted.py::test_weighted_sum_nan[True-weights1-4]\", \"xarray/tests/test_weighted.py::test_weighted_sum_nan[True-weights2-0]\", \"xarray/tests/test_weighted.py::test_weighted_sum_nan[True-weights3-0]\", \"xarray/tests/test_weighted.py::test_weighted_sum_nan[False-weights0-4]\", \"xarray/tests/test_weighted.py::test_weighted_sum_nan[False-weights1-4]\", \"xarray/tests/test_weighted.py::test_weighted_sum_nan[False-weights2-0]\", \"xarray/tests/test_weighted.py::test_weighted_sum_nan[False-weights3-0]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[1-True-da0]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[1-True-da1]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[1-True-da2]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[1-False-da0]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[1-False-da1]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[1-False-da2]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[2-True-da0]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[2-True-da1]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[2-True-da2]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[2-False-da0]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[2-False-da1]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[2-False-da2]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[3.14-True-da0]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[3.14-True-da1]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[3.14-True-da2]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[3.14-False-da0]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[3.14-False-da1]\", \"xarray/tests/test_weighted.py::test_weighted_mean_equal_weights[3.14-False-da2]\", \"xarray/tests/test_weighted.py::test_weighted_mean_no_nan[weights0-1.6]\", \"xarray/tests/test_weighted.py::test_weighted_mean_no_nan[weights1-1.0]\", \"xarray/tests/test_weighted.py::test_weighted_mean_no_nan[weights2-nan]\", \"xarray/tests/test_weighted.py::test_weighted_mean_nan[True-weights0-2.0]\", \"xarray/tests/test_weighted.py::test_weighted_mean_nan[True-weights1-nan]\", \"xarray/tests/test_weighted.py::test_weighted_mean_nan[True-weights2-nan]\", \"xarray/tests/test_weighted.py::test_weighted_mean_nan[False-weights0-2.0]\", \"xarray/tests/test_weighted.py::test_weighted_mean_nan[False-weights1-nan]\", \"xarray/tests/test_weighted.py::test_weighted_mean_nan[False-weights2-nan]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum_of_weights-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum_of_weights-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum_of_weights-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum_of_weights-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum_of_weights-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum_of_weights-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-sum-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-mean-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-mean-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-mean-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-mean-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-mean-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-True-mean-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum_of_weights-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum_of_weights-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum_of_weights-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum_of_weights-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum_of_weights-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum_of_weights-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-sum-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-mean-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-mean-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-mean-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-mean-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-mean-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-None-False-mean-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum_of_weights-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum_of_weights-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum_of_weights-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum_of_weights-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum_of_weights-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum_of_weights-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-sum-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-mean-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-mean-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-mean-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-mean-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-mean-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-True-mean-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum_of_weights-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum_of_weights-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum_of_weights-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum_of_weights-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum_of_weights-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum_of_weights-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-sum-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-mean-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-mean-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-mean-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-mean-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-mean-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-True-False-mean-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum_of_weights-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum_of_weights-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum_of_weights-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum_of_weights-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum_of_weights-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum_of_weights-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-sum-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-mean-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-mean-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-mean-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-mean-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-mean-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-True-mean-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum_of_weights-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum_of_weights-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum_of_weights-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum_of_weights-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum_of_weights-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum_of_weights-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-sum-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-mean-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-mean-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-mean-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-mean-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-mean-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[True-False-False-mean-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum_of_weights-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum_of_weights-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum_of_weights-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum_of_weights-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum_of_weights-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum_of_weights-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-sum-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-mean-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-mean-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-mean-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-mean-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-mean-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-True-mean-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum_of_weights-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum_of_weights-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum_of_weights-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum_of_weights-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum_of_weights-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum_of_weights-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-sum-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-mean-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-mean-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-mean-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-mean-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-mean-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-None-False-mean-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum_of_weights-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum_of_weights-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum_of_weights-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum_of_weights-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum_of_weights-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum_of_weights-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-sum-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-mean-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-mean-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-mean-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-mean-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-mean-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-True-mean-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum_of_weights-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum_of_weights-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum_of_weights-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum_of_weights-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum_of_weights-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum_of_weights-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-sum-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-mean-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-mean-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-mean-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-mean-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-mean-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-True-False-mean-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum_of_weights-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum_of_weights-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum_of_weights-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum_of_weights-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum_of_weights-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum_of_weights-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-sum-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-mean-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-mean-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-mean-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-mean-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-mean-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-True-mean-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum_of_weights-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum_of_weights-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum_of_weights-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum_of_weights-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum_of_weights-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum_of_weights-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-sum-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-mean-a]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-mean-b]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-mean-c]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-mean-dim3]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-mean-dim4]\", \"xarray/tests/test_weighted.py::test_weighted_operations_3D[False-False-False-mean-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum_of_weights-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-sum-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-True-mean-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum_of_weights-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-sum-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-None-False-mean-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum_of_weights-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-sum-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-True-mean-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum_of_weights-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-sum-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-True-False-mean-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum_of_weights-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-sum-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-True-mean-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum_of_weights-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-sum-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[True-False-False-mean-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum_of_weights-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-sum-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-True-mean-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum_of_weights-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-sum-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-None-False-mean-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum_of_weights-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-sum-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-True-mean-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum_of_weights-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-sum-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-True-False-mean-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum_of_weights-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-sum-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-True-mean-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum_of_weights-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-sum-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights0-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights0-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights0-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights0-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights0-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights0-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights1-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights1-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights1-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights1-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights1-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights1-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights2-shape_data0-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights2-shape_data0-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights2-shape_data1-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights2-shape_data1-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights2-shape_data2-dim_0]\", \"xarray/tests/test_weighted.py::test_weighted_operations_different_shapes[False-False-False-mean-shape_weights2-shape_data2-None]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[True-True-sum_of_weights]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[True-True-sum]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[True-True-mean]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[True-False-sum_of_weights]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[True-False-sum]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[True-False-mean]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[False-True-sum_of_weights]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[False-True-sum]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[False-True-mean]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[False-False-sum_of_weights]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[False-False-sum]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[False-False-mean]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[None-True-sum_of_weights]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[None-True-sum]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[None-True-mean]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[None-False-sum_of_weights]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[None-False-sum]\", \"xarray/tests/test_weighted.py::test_weighted_operations_keep_attr[None-False-mean]\"]",
  "PASS_TO_PASS": "[\"xarray/tests/test_weighted.py::test_weighted_operations_nonequal_coords[True-sum_of_weights]\", \"xarray/tests/test_weighted.py::test_weighted_operations_nonequal_coords[True-sum]\", \"xarray/tests/test_weighted.py::test_weighted_operations_nonequal_coords[True-mean]\", \"xarray/tests/test_weighted.py::test_weighted_operations_nonequal_coords[False-sum_of_weights]\", \"xarray/tests/test_weighted.py::test_weighted_operations_nonequal_coords[False-sum]\", \"xarray/tests/test_weighted.py::test_weighted_operations_nonequal_coords[False-mean]\"]",
  "environment_setup_commit": "1c198a191127c601d091213c4b3292a8bb3054e1",
  "_download_metadata": {
    "downloaded_at": "2025-10-07T21:23:30.867365",
    "dataset_name": "swe-bench",
    "split": "test",
    "downloader_version": "0.1.0"
  }
}