{
  "repo": "pytest-dev/pytest",
  "instance_id": "pytest-dev__pytest-8641",
  "base_commit": "634312b14a45db8d60d72016e01294284e3a18d4",
  "patch": "diff --git a/src/_pytest/logging.py b/src/_pytest/logging.py\n--- a/src/_pytest/logging.py\n+++ b/src/_pytest/logging.py\n@@ -59,7 +59,7 @@ class ColoredLevelFormatter(logging.Formatter):\n         logging.DEBUG: {\"purple\"},\n         logging.NOTSET: set(),\n     }\n-    LEVELNAME_FMT_REGEX = re.compile(r\"%\\(levelname\\)([+-.]?\\d*s)\")\n+    LEVELNAME_FMT_REGEX = re.compile(r\"%\\(levelname\\)([+-.]?\\d*(?:\\.\\d+)?s)\")\n \n     def __init__(self, terminalwriter: TerminalWriter, *args, **kwargs) -> None:\n         super().__init__(*args, **kwargs)\n",
  "test_patch": "diff --git a/testing/logging/test_formatter.py b/testing/logging/test_formatter.py\n--- a/testing/logging/test_formatter.py\n+++ b/testing/logging/test_formatter.py\n@@ -18,9 +18,32 @@ def test_coloredlogformatter() -> None:\n         exc_info=None,\n     )\n \n-    class ColorConfig:\n-        class option:\n-            pass\n+    tw = TerminalWriter()\n+    tw.hasmarkup = True\n+    formatter = ColoredLevelFormatter(tw, logfmt)\n+    output = formatter.format(record)\n+    assert output == (\n+        \"dummypath                   10 \\x1b[32mINFO    \\x1b[0m Test Message\"\n+    )\n+\n+    tw.hasmarkup = False\n+    formatter = ColoredLevelFormatter(tw, logfmt)\n+    output = formatter.format(record)\n+    assert output == (\"dummypath                   10 INFO     Test Message\")\n+\n+\n+def test_coloredlogformatter_with_width_precision() -> None:\n+    logfmt = \"%(filename)-25s %(lineno)4d %(levelname)-8.8s %(message)s\"\n+\n+    record = logging.LogRecord(\n+        name=\"dummy\",\n+        level=logging.INFO,\n+        pathname=\"dummypath\",\n+        lineno=10,\n+        msg=\"Test Message\",\n+        args=(),\n+        exc_info=None,\n+    )\n \n     tw = TerminalWriter()\n     tw.hasmarkup = True\n",
  "problem_statement": "No color output when specifying log format string with precision-formatted levelname\n<!--\r\nThanks for submitting an issue!\r\n\r\nQuick check-list while reporting bugs:\r\n-->\r\n\r\nPytest fails to output colorfully with the following log format string in `pytest.ini`\r\n```ini\r\nlog_cli_format: %(asctime)s %(funcNamewithModule)-40.40s L%(lineno)-.4d %(levelname)-5.5s| %(message)s\r\n```\r\nThis is due to [`ColoredLevelFormatter.LEVELNAME_FMT_REGEX`](https://github.com/pytest-dev/pytest/blob/9653a0e9f47ad2ae5135a974db52ddeb5bfcf5d9/src/_pytest/logging.py#L62) fails to match the format string due to the presence of precision bit.\r\n\r\n\r\n\n",
  "hints_text": "",
  "created_at": "2021-05-06T19:22:55Z",
  "version": "6.3",
  "FAIL_TO_PASS": "[\"testing/logging/test_formatter.py::test_coloredlogformatter_with_width_precision\"]",
  "PASS_TO_PASS": "[\"testing/logging/test_formatter.py::test_coloredlogformatter\", \"testing/logging/test_formatter.py::test_multiline_message\", \"testing/logging/test_formatter.py::test_colored_short_level\"]",
  "environment_setup_commit": "634312b14a45db8d60d72016e01294284e3a18d4",
  "_download_metadata": {
    "downloaded_at": "2025-10-07T21:23:30.944026",
    "dataset_name": "swe-bench",
    "split": "test",
    "downloader_version": "0.1.0"
  }
}