{
  "repo": "django/django",
  "instance_id": "django__django-15204",
  "base_commit": "b0d16d0129b7cc5978a8d55d2331a34cb369e6c7",
  "patch": "diff --git a/django/utils/dateparse.py b/django/utils/dateparse.py\n--- a/django/utils/dateparse.py\n+++ b/django/utils/dateparse.py\n@@ -42,11 +42,11 @@\n iso8601_duration_re = _lazy_re_compile(\n     r'^(?P<sign>[-+]?)'\n     r'P'\n-    r'(?:(?P<days>\\d+(.\\d+)?)D)?'\n+    r'(?:(?P<days>\\d+([\\.,]\\d+)?)D)?'\n     r'(?:T'\n-    r'(?:(?P<hours>\\d+(.\\d+)?)H)?'\n-    r'(?:(?P<minutes>\\d+(.\\d+)?)M)?'\n-    r'(?:(?P<seconds>\\d+(.\\d+)?)S)?'\n+    r'(?:(?P<hours>\\d+([\\.,]\\d+)?)H)?'\n+    r'(?:(?P<minutes>\\d+([\\.,]\\d+)?)M)?'\n+    r'(?:(?P<seconds>\\d+([\\.,]\\d+)?)S)?'\n     r')?'\n     r'$'\n )\n",
  "test_patch": "diff --git a/tests/forms_tests/field_tests/test_durationfield.py b/tests/forms_tests/field_tests/test_durationfield.py\n--- a/tests/forms_tests/field_tests/test_durationfield.py\n+++ b/tests/forms_tests/field_tests/test_durationfield.py\n@@ -30,6 +30,8 @@ def test_durationfield_clean(self):\n         msg = 'Enter a valid duration.'\n         with self.assertRaisesMessage(ValidationError, msg):\n             f.clean('not_a_time')\n+        with self.assertRaisesMessage(ValidationError, msg):\n+            DurationField().clean('P3(3D')\n \n     def test_durationfield_clean_not_required(self):\n         f = DurationField(required=False)\ndiff --git a/tests/utils_tests/test_dateparse.py b/tests/utils_tests/test_dateparse.py\n--- a/tests/utils_tests/test_dateparse.py\n+++ b/tests/utils_tests/test_dateparse.py\n@@ -161,6 +161,11 @@ def test_iso_8601(self):\n             ('-PT0.000005S', timedelta(microseconds=-5)),\n             ('-PT0,000005S', timedelta(microseconds=-5)),\n             ('-P4DT1H', timedelta(days=-4, hours=-1)),\n+            # Invalid separators for decimal fractions.\n+            ('P3(3D', None),\n+            ('PT3)3H', None),\n+            ('PT3|3M', None),\n+            ('PT3/3S', None),\n         )\n         for source, expected in test_values:\n             with self.subTest(source=source):\n",
  "problem_statement": "Durationfield.clean fails to handle broken data\nDescription\n\t \n\t\t(last modified by Florian Apolloner)\n\t \nThe actual input string was 'P3(3D' \n === Uncaught Python exception: ===\n\tValueError: could not convert string to float: '3(3'\n\tTraceback (most recent call last):\n\t File \"basic_fuzzer.py\", line 22, in TestOneInput\n\t File \"fuzzers.py\", line 294, in test_forms_DurationField\n\t File \"django/forms/fields.py\", line 149, in clean\n\t File \"django/forms/fields.py\", line 502, in to_python\n\t File \"django/utils/dateparse.py\", line 154, in parse_duration\n\t File \"django/utils/dateparse.py\", line 154, in <dictcomp>\n",
  "hints_text": "",
  "created_at": "2021-12-15T17:08:34Z",
  "version": "4.1",
  "FAIL_TO_PASS": "[\"test_iso_8601 (utils_tests.test_dateparse.DurationParseTests)\", \"test_minutes_seconds (utils_tests.test_dateparse.DurationParseTests)\", \"test_durationfield_clean (forms_tests.field_tests.test_durationfield.DurationFieldTest)\"]",
  "PASS_TO_PASS": "[\"test_parse_date (utils_tests.test_dateparse.DateParseTests)\", \"test_parse_datetime (utils_tests.test_dateparse.DateParseTests)\", \"test_parse_time (utils_tests.test_dateparse.DateParseTests)\", \"test_days (utils_tests.test_dateparse.DurationParseTests)\", \"test_fractions_of_seconds (utils_tests.test_dateparse.DurationParseTests)\", \"test_hours_minutes_seconds (utils_tests.test_dateparse.DurationParseTests)\", \"test_negative (utils_tests.test_dateparse.DurationParseTests)\", \"test_parse_postgresql_format (utils_tests.test_dateparse.DurationParseTests)\", \"test_parse_python_format (utils_tests.test_dateparse.DurationParseTests)\", \"test_seconds (utils_tests.test_dateparse.DurationParseTests)\", \"test_durationfield_clean_not_required (forms_tests.field_tests.test_durationfield.DurationFieldTest)\", \"test_durationfield_integer_value (forms_tests.field_tests.test_durationfield.DurationFieldTest)\", \"test_durationfield_prepare_value (forms_tests.field_tests.test_durationfield.DurationFieldTest)\", \"test_durationfield_render (forms_tests.field_tests.test_durationfield.DurationFieldTest)\", \"test_overflow (forms_tests.field_tests.test_durationfield.DurationFieldTest)\", \"test_overflow_translation (forms_tests.field_tests.test_durationfield.DurationFieldTest)\"]",
  "environment_setup_commit": "647480166bfe7532e8c471fef0146e3a17e6c0c9",
  "_download_metadata": {
    "downloaded_at": "2025-10-07T21:23:30.721541",
    "dataset_name": "swe-bench",
    "split": "test",
    "downloader_version": "0.1.0"
  }
}