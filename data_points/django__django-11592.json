{
  "repo": "django/django",
  "instance_id": "django__django-11592",
  "base_commit": "806ba19bbff311b7d567857ae61db6ff84af4a2c",
  "patch": "diff --git a/django/core/handlers/wsgi.py b/django/core/handlers/wsgi.py\n--- a/django/core/handlers/wsgi.py\n+++ b/django/core/handlers/wsgi.py\n@@ -141,7 +141,7 @@ def __call__(self, environ, start_response):\n         ]\n         start_response(status, response_headers)\n         if getattr(response, 'file_to_stream', None) is not None and environ.get('wsgi.file_wrapper'):\n-            response = environ['wsgi.file_wrapper'](response.file_to_stream)\n+            response = environ['wsgi.file_wrapper'](response.file_to_stream, response.block_size)\n         return response\n \n \n",
  "test_patch": "diff --git a/tests/wsgi/tests.py b/tests/wsgi/tests.py\n--- a/tests/wsgi/tests.py\n+++ b/tests/wsgi/tests.py\n@@ -3,6 +3,7 @@\n from django.core.signals import request_started\n from django.core.wsgi import get_wsgi_application\n from django.db import close_old_connections\n+from django.http import FileResponse\n from django.test import SimpleTestCase, override_settings\n from django.test.client import RequestFactory\n \n@@ -51,7 +52,8 @@ def test_file_wrapper(self):\n         FileResponse uses wsgi.file_wrapper.\n         \"\"\"\n         class FileWrapper:\n-            def __init__(self, filelike, blksize=8192):\n+            def __init__(self, filelike, block_size=None):\n+                self.block_size = block_size\n                 filelike.close()\n         application = get_wsgi_application()\n         environ = self.request_factory._base_environ(\n@@ -67,6 +69,7 @@ def start_response(status, headers):\n         response = application(environ, start_response)\n         self.assertEqual(response_data['status'], '200 OK')\n         self.assertIsInstance(response, FileWrapper)\n+        self.assertEqual(response.block_size, FileResponse.block_size)\n \n \n class GetInternalWSGIApplicationTest(SimpleTestCase):\n",
  "problem_statement": "Start passing FileResponse.block_size to wsgi.file_wrapper.\nDescription\n\t \n\t\t(last modified by Chris Jerdonek)\n\t \nI noticed that Django's FileResponse class has a block_size attribute which can be customized by subclassing: ​https://github.com/django/django/blob/415e899dc46c2f8d667ff11d3e54eff759eaded4/django/http/response.py#L393\nbut it's not passed to wsgi.file_wrapper. Only the filelike object is passed:\nresponse = environ['wsgi.file_wrapper'](response.file_to_stream)\n(from: ​https://github.com/django/django/blob/415e899dc46c2f8d667ff11d3e54eff759eaded4/django/core/handlers/wsgi.py#L144 )\n",
  "hints_text": "Seems reasonable, Thanks (see ​example-of-wrapper-usage).",
  "created_at": "2019-07-24T17:10:08Z",
  "version": "3.0",
  "FAIL_TO_PASS": "[\"test_file_wrapper (wsgi.tests.WSGITest)\"]",
  "PASS_TO_PASS": "[\"test_bad_module (wsgi.tests.GetInternalWSGIApplicationTest)\", \"test_bad_name (wsgi.tests.GetInternalWSGIApplicationTest)\", \"test_default (wsgi.tests.GetInternalWSGIApplicationTest)\", \"test_success (wsgi.tests.GetInternalWSGIApplicationTest)\", \"test_get_wsgi_application (wsgi.tests.WSGITest)\"]",
  "environment_setup_commit": "419a78300f7cd27611196e1e464d50fd0385ff27",
  "_download_metadata": {
    "downloaded_at": "2025-10-07T21:23:30.578105",
    "dataset_name": "swe-bench",
    "split": "test",
    "downloader_version": "0.1.0"
  }
}