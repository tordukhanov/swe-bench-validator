{
  "repo": "sympy/sympy",
  "instance_id": "sympy__sympy-11438",
  "base_commit": "46e3e96e5a6a16f340320585299ed577e1bf882d",
  "patch": "diff --git a/sympy/solvers/diophantine.py b/sympy/solvers/diophantine.py\n--- a/sympy/solvers/diophantine.py\n+++ b/sympy/solvers/diophantine.py\n@@ -402,7 +402,7 @@ def classify_diop(eq, _dict=True):\n         diop_type = \"cubic_thue\"\n \n     elif (total_degree > 3 and total_degree % 2 == 0 and\n-            all(k.is_Pow for k in coeff if k != 1)):\n+            all(k.is_Pow and k.exp == total_degree for k in coeff if k != 1)):\n         if all(coeff[k] == 1 for k in coeff if k != 1):\n             diop_type = 'general_sum_of_even_powers'\n \n",
  "test_patch": "diff --git a/sympy/solvers/tests/test_diophantine.py b/sympy/solvers/tests/test_diophantine.py\n--- a/sympy/solvers/tests/test_diophantine.py\n+++ b/sympy/solvers/tests/test_diophantine.py\n@@ -46,6 +46,7 @@ def test_classify_diop():\n     raises(TypeError, lambda: classify_diop(x**2/3 - 1))\n     raises(ValueError, lambda: classify_diop(1))\n     raises(NotImplementedError, lambda: classify_diop(w*x*y*z - 1))\n+    raises(NotImplementedError, lambda: classify_diop(x**3 + y**3 + z**4 - 90))\n     assert classify_diop(14*x**2 + 15*x - 42) == (\n         [x], {1: -42, x: 15, x**2: 14}, 'univariate')\n     assert classify_diop(x*y + z) == (\n@@ -60,6 +61,8 @@ def test_classify_diop():\n         [w, x, y, z], {x*y: 1, w*z: 1}, 'homogeneous_general_quadratic')\n     assert classify_diop(x*y**2 + 1) == (\n         [x, y], {x*y**2: 1, 1: 1}, 'cubic_thue')\n+    assert classify_diop(x**4 + y**4 + z**4 - (1 + 16 + 81)) == (\n+        [x, y, z], {1: -98, x**4: 1, z**4: 1, y**4: 1}, 'general_sum_of_even_powers')\n \n \n def test_linear():\n",
  "problem_statement": "diophantine: misclassification\n``` python\n>>> eq = x**2+y**2+z**4-(1+4+2**4)\n>>> classify_diop(eq)\n([x, y, z], {1: -21, y**2: 1, x**2: 1, z**4: 1}, 'general_sum_of_even_powers')\n>>> diophantine(eq)\nset([])\n```\n\nA check should be made that all powers are the same (not only that they are even).\n\n",
  "hints_text": "I would like to work on this issue. Please guide me\n\nIt appears it is not checking even if they are even, ~~but only if their sum is even.~~\n(Edit: I was mistaken, `total_degree` is not the sum.)\n\n``` python\n>>> eq = x**3 + y**3 + z**4 - (1 + 8 + 81)\n>>> classify_diop(eq)\n([x, y, z], {1: -90, y**3: 1, z**4: 1, x**3: 1}, 'general_sum_of_even_powers')\n>>> diophantine(eq)\nset()\n```\n\nAlso, if the powers are supposed to be the same, I think the name `'general_sum_of_even_powers'` is very misleading.\n\nThe relevant file is sympy/solvers/diophantine.py. One could start by checking the function `classify_diop`.\n\n@karthikkalidas Are you working on this issue or still want to?\n\nOtherwise I would like to work on it.\n\nNo you go ahead!\n\nOn 28 Jul 2016 01:18, \"Gabriel Orisaka\" notifications@github.com wrote:\n\n> The relevant file is sympy/solvers/diophantine.py. One could start by\n> checking the function classify_diop.\n> \n> @karthikkalidas https://github.com/karthikkalidas Are you working on\n> this issue or still want to?\n> \n> Otherwise I would like to work on it.\n> \n> â€”\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> https://github.com/sympy/sympy/issues/11418#issuecomment-235698771, or mute\n> the thread\n> https://github.com/notifications/unsubscribe-auth/ASBqq4iJzsR9jQwGPX98PctLrYBjqOPHks5qZ7XwgaJpZM4JR3U1\n> .\n",
  "created_at": "2016-07-28T03:14:09Z",
  "version": "1.0",
  "FAIL_TO_PASS": "[\"test_classify_diop\"]",
  "PASS_TO_PASS": "[\"test_input_format\", \"test_univariate\", \"test_linear\", \"test_quadratic_simple_hyperbolic_case\", \"test_quadratic_elliptical_case\", \"test_quadratic_perfect_square\", \"test_transformation_to_pell\", \"test_find_DN\", \"test_ldescent\", \"test_transformation_to_normal\", \"test_square_factor\", \"test_no_square_ternary_quadratic\", \"test_general_pythagorean\", \"test_diop_partition\", \"test_prime_as_sum_of_two_squares\", \"test_sum_of_three_squares\", \"test_sum_of_four_squares\", \"test_power_representation\", \"test_holzer\", \"test_issue_9539\", \"test_diop_sum_of_even_powers\", \"test_sum_of_squares_powers\", \"test__can_do_sum_of_squares\"]",
  "environment_setup_commit": "50b81f9f6be151014501ffac44e5dc6b2416938f",
  "_download_metadata": {
    "downloaded_at": "2025-10-07T21:23:31.072240",
    "dataset_name": "swe-bench",
    "split": "test",
    "downloader_version": "0.1.0"
  }
}