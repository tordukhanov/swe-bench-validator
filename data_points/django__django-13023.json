{
  "repo": "django/django",
  "instance_id": "django__django-13023",
  "base_commit": "f83b44075dafa429d59e8755aa47e15577cc49f9",
  "patch": "diff --git a/django/db/models/fields/__init__.py b/django/db/models/fields/__init__.py\n--- a/django/db/models/fields/__init__.py\n+++ b/django/db/models/fields/__init__.py\n@@ -1501,7 +1501,7 @@ def to_python(self, value):\n             return self.context.create_decimal_from_float(value)\n         try:\n             return decimal.Decimal(value)\n-        except decimal.InvalidOperation:\n+        except (decimal.InvalidOperation, TypeError, ValueError):\n             raise exceptions.ValidationError(\n                 self.error_messages['invalid'],\n                 code='invalid',\n",
  "test_patch": "diff --git a/tests/model_fields/test_decimalfield.py b/tests/model_fields/test_decimalfield.py\n--- a/tests/model_fields/test_decimalfield.py\n+++ b/tests/model_fields/test_decimalfield.py\n@@ -21,9 +21,24 @@ def test_to_python(self):\n         # Uses default rounding of ROUND_HALF_EVEN.\n         self.assertEqual(f.to_python(2.0625), Decimal('2.062'))\n         self.assertEqual(f.to_python(2.1875), Decimal('2.188'))\n-        msg = '“abc” value must be a decimal number.'\n-        with self.assertRaisesMessage(ValidationError, msg):\n-            f.to_python('abc')\n+\n+    def test_invalid_value(self):\n+        field = models.DecimalField(max_digits=4, decimal_places=2)\n+        msg = '“%s” value must be a decimal number.'\n+        tests = [\n+            (),\n+            [],\n+            {},\n+            set(),\n+            object(),\n+            complex(),\n+            'non-numeric string',\n+            b'non-numeric byte-string',\n+        ]\n+        for value in tests:\n+            with self.subTest(value):\n+                with self.assertRaisesMessage(ValidationError, msg % (value,)):\n+                    field.clean(value, None)\n \n     def test_default(self):\n         f = models.DecimalField(default=Decimal('0.00'))\n",
  "problem_statement": "DecimalField.to_python() raises TypeError on dict values.\nDescription\n\t\nA call to DecimalField.to_python() with a dictionary as the value parameter produces TypeError instead of ValidationError. This is a problem, for example, when you try to save a model object, and a decimal field got set to a dictionary by mistake. The TypeError exception that comes back makes it hard to track the problem to the field if the object has a lot of fields.\nI am proposing a patch to fix it:\n​https://github.com/django/django/pull/13023\n",
  "hints_text": "",
  "created_at": "2020-06-04T20:40:44Z",
  "version": "3.2",
  "FAIL_TO_PASS": "[\"test_invalid_value (model_fields.test_decimalfield.DecimalFieldTests)\", \"test_lookup_really_big_value (model_fields.test_decimalfield.DecimalFieldTests)\"]",
  "PASS_TO_PASS": "[\"test_default (model_fields.test_decimalfield.DecimalFieldTests)\", \"test_filter_with_strings (model_fields.test_decimalfield.DecimalFieldTests)\", \"test_get_prep_value (model_fields.test_decimalfield.DecimalFieldTests)\", \"test_max_decimal_places_validation (model_fields.test_decimalfield.DecimalFieldTests)\", \"test_max_digits_validation (model_fields.test_decimalfield.DecimalFieldTests)\", \"test_max_whole_digits_validation (model_fields.test_decimalfield.DecimalFieldTests)\", \"Trailing zeros in the fractional part aren't truncated.\", \"test_save_without_float_conversion (model_fields.test_decimalfield.DecimalFieldTests)\", \"test_to_python (model_fields.test_decimalfield.DecimalFieldTests)\"]",
  "environment_setup_commit": "65dfb06a1ab56c238cc80f5e1c31f61210c4577d",
  "_download_metadata": {
    "downloaded_at": "2025-10-07T21:23:30.641346",
    "dataset_name": "swe-bench",
    "split": "test",
    "downloader_version": "0.1.0"
  }
}