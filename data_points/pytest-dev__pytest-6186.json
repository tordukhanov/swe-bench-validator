{
  "repo": "pytest-dev/pytest",
  "instance_id": "pytest-dev__pytest-6186",
  "base_commit": "f91bf48a40da5ee7f7c2a3c71ee56d854d35e983",
  "patch": "diff --git a/src/_pytest/deprecated.py b/src/_pytest/deprecated.py\n--- a/src/_pytest/deprecated.py\n+++ b/src/_pytest/deprecated.py\n@@ -34,3 +34,8 @@\n     \"Passing arguments to pytest.fixture() as positional arguments is deprecated - pass them \"\n     \"as a keyword argument instead.\"\n )\n+\n+JUNIT_XML_DEFAULT_FAMILY = PytestDeprecationWarning(\n+    \"The 'junit_family' default value will change to 'xunit2' in pytest 6.0.\\n\"\n+    \"Add 'junit_family=legacy' to your pytest.ini file to silence this warning and make your suite compatible.\"\n+)\ndiff --git a/src/_pytest/junitxml.py b/src/_pytest/junitxml.py\n--- a/src/_pytest/junitxml.py\n+++ b/src/_pytest/junitxml.py\n@@ -19,8 +19,10 @@\n import py\n \n import pytest\n+from _pytest import deprecated\n from _pytest import nodes\n from _pytest.config import filename_arg\n+from _pytest.warnings import _issue_warning_captured\n \n \n class Junit(py.xml.Namespace):\n@@ -421,9 +423,7 @@ def pytest_addoption(parser):\n         default=\"total\",\n     )  # choices=['total', 'call'])\n     parser.addini(\n-        \"junit_family\",\n-        \"Emit XML for schema: one of legacy|xunit1|xunit2\",\n-        default=\"xunit1\",\n+        \"junit_family\", \"Emit XML for schema: one of legacy|xunit1|xunit2\", default=None\n     )\n \n \n@@ -431,13 +431,17 @@ def pytest_configure(config):\n     xmlpath = config.option.xmlpath\n     # prevent opening xmllog on slave nodes (xdist)\n     if xmlpath and not hasattr(config, \"slaveinput\"):\n+        junit_family = config.getini(\"junit_family\")\n+        if not junit_family:\n+            _issue_warning_captured(deprecated.JUNIT_XML_DEFAULT_FAMILY, config.hook, 2)\n+            junit_family = \"xunit1\"\n         config._xml = LogXML(\n             xmlpath,\n             config.option.junitprefix,\n             config.getini(\"junit_suite_name\"),\n             config.getini(\"junit_logging\"),\n             config.getini(\"junit_duration_report\"),\n-            config.getini(\"junit_family\"),\n+            junit_family,\n             config.getini(\"junit_log_passing_tests\"),\n         )\n         config.pluginmanager.register(config._xml)\n",
  "test_patch": "diff --git a/testing/deprecated_test.py b/testing/deprecated_test.py\n--- a/testing/deprecated_test.py\n+++ b/testing/deprecated_test.py\n@@ -44,3 +44,32 @@ def test_external_plugins_integrated(testdir, plugin):\n \n     with pytest.warns(pytest.PytestConfigWarning):\n         testdir.parseconfig(\"-p\", plugin)\n+\n+\n+@pytest.mark.parametrize(\"junit_family\", [None, \"legacy\", \"xunit2\"])\n+def test_warn_about_imminent_junit_family_default_change(testdir, junit_family):\n+    \"\"\"Show a warning if junit_family is not defined and --junitxml is used (#6179)\"\"\"\n+    testdir.makepyfile(\n+        \"\"\"\n+        def test_foo():\n+            pass\n+    \"\"\"\n+    )\n+    if junit_family:\n+        testdir.makeini(\n+            \"\"\"\n+            [pytest]\n+            junit_family={junit_family}\n+        \"\"\".format(\n+                junit_family=junit_family\n+            )\n+        )\n+\n+    result = testdir.runpytest(\"--junit-xml=foo.xml\")\n+    warning_msg = (\n+        \"*PytestDeprecationWarning: The 'junit_family' default value will change*\"\n+    )\n+    if junit_family:\n+        result.stdout.no_fnmatch_line(warning_msg)\n+    else:\n+        result.stdout.fnmatch_lines([warning_msg])\n",
  "problem_statement": "Show deprecation warning if junit_family is not set\nShow a deprecation warning if the user has not configured `junit_family` (#6178)\n",
  "hints_text": "",
  "created_at": "2019-11-13T21:24:32Z",
  "version": "5.2",
  "FAIL_TO_PASS": "[\"testing/deprecated_test.py::test_warn_about_imminent_junit_family_default_change[None]\"]",
  "PASS_TO_PASS": "[\"testing/deprecated_test.py::test_terminal_reporter_writer_attr\", \"testing/deprecated_test.py::test_resultlog_is_deprecated\", \"testing/deprecated_test.py::test_external_plugins_integrated[pytest_capturelog]\", \"testing/deprecated_test.py::test_external_plugins_integrated[pytest_catchlog]\", \"testing/deprecated_test.py::test_external_plugins_integrated[pytest_faulthandler]\", \"testing/deprecated_test.py::test_warn_about_imminent_junit_family_default_change[legacy]\", \"testing/deprecated_test.py::test_warn_about_imminent_junit_family_default_change[xunit2]\"]",
  "environment_setup_commit": "f36ea240fe3579f945bf5d6cc41b5e45a572249d",
  "_download_metadata": {
    "downloaded_at": "2025-10-07T21:23:30.931118",
    "dataset_name": "swe-bench",
    "split": "test",
    "downloader_version": "0.1.0"
  }
}